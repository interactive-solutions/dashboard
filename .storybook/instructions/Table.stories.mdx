import { Meta } from '@storybook/addon-docs';

<Meta title="Instructions/Table" />

# Table

We are using [React Table](https://tanstack.com/table/v8).

## Example setup

```tsx
import { useCallback, useMemo } from 'react';

import { ColumnDef } from '@tanstack/react-table';

import { ExampleQuery, useExampleLazyQuery } from 'api/graphql';
import { Table } from 'components/ui/table';
import { useTable } from 'hooks';
import { TableFetchDataVariables } from 'types/table';

const Component = () => {
  const [fetchExample, { data, loading, error }] = useExampleLazyQuery();
  const { getPageCount, getFetchDataVariables } = useTable();

  const columns = useMemo<ColumnDef<ExampleQuery['examples']['edges'][0]>[]>(
    () => [
      {
        header: 'Title',
        accessorKey: 'title'
      },
      {
        header: 'Something',
        accessorFn: ({ something }) => something,
        cell: ({ row }) => <div>{row.original.something}</div>
      },
      {
        header: 'Trigger',
        enableSorting: false,
        cell: ({ row }) => (
          <button type="button" onClick={() => console.log(row.original.id)}>
            Button
          </button>
        )
      }
    ],
    []
  );

  const handleFetchData = useCallback(
    (variables: TableFetchDataVariables) => {
      const { filter, sorting } = getFetchDataVariables(variables);
      fetchExample({ variables: { filter, sorting } });
    },
    [fetchExample, getFetchDataVariables]
  );

  return (
    <Table
      data={data?.examples.edges || []}
      columns={columns}
      onFetchData={handleFetchData}
      loading={loading}
      sorting
      pagination
      pageCount={getPageCount(data?.examples.meta)}
      error={error}
      handleQueryParameters // Only works client side
      search
    />
  );
};
```
